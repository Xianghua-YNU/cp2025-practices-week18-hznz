      
# 实验报告：利用辅助函数法计算积分

**学生姓名：** [邹远诏] 

**学号：** [20231050213] 

**完成日期：** [2025.6.25]

## 一、实验目的
利用辅助函数法计算积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$，导出由 0 到 1 之间均匀分布随机数产生满足权重函数 $p(x) = {1\over2\sqrt{x}}$ 分布的随机数公式，抽取 $N = 1000000$ 个随机数据点估计积分，并利用公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 估计积分结果的统计误差。

## 二、实验原理
### 2.1 积分计算原理
辅助函数法是一种基于重要性采样的Monte Carlo积分方法。对于目标积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$，我们引入权重函数 $p(x) = {1\over2\sqrt{x}}$。这个权重函数的选择可以消除被积函数中的奇异性（x^(-1/2)项），使得采样更加有效。

通过引入权重函数，积分可以改写为：
$I = \int_0^1 \frac{1}{e^x + 1} \cdot \frac{1}{2\sqrt{x}} \cdot 2 dx = 2\left\langle \frac{1}{e^x + 1}\right\rangle$


### 2.2 随机数生成原理
要从均匀分布生成服从p(x)分布的随机数，采用累积分布函数方法：

1. 设U为[0,1]均匀分布随机数
2. 求解方程：$\int_0^x p(t)dt = U$
3. 代入p(x)：$\int_0^x \frac{1}{2\sqrt{t}}dt = U$
4. 积分得到：$[\sqrt{t}]_0^x = U$
5. 即：$\sqrt{x} = U$
6. 最终得到：$x = U^2$


### 2.3 误差估计原理
统计误差估计公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 中，var f 是采样函数值的方差，通过 ${\rm var}f = \langle f^2\rangle - \langle f\rangle^2$ 计算。这里 $\langle f^2\rangle$ 表示f的平方的期望值，$\langle f\rangle^2$ 表示f的期望值的平方。N为采样点数，误差随着采样点数的增加而减小。

## 三、实验环境
### 3.1 硬件环境
- 计算机型号：[LAPTOP-31I94U6C]
- CPU：[AMD Ryzen 7 7840H w/ Radeon 780M Graphics   3.80 GHz]
- 内存：[512G]

### 3.2 软件环境
- 操作系统：[Win11]
- 编程语言：[Python]
- 开发工具：[Python 3.11.5]

## 四、实验步骤
### 4.1 随机数生成公式实现
给出推导出的随机数生成公式，并编写代码实现该公式，附上关键代码片段。
```python
# 此处填写生成满足 p(x) 分布随机数的代码示例
def generate_samples(N):
    """生成服从p(x) = 1/(2√x)分布的随机数"""
    U = np.random.random(N)
    X = U * U  # 使用推导出的公式 x = U²
    return X
```

### 4.2 积分估计
编写代码抽取 $N = 1000000$ 个随机数据点并估计积分值，附上关键代码片段。
```python
# 此处填写积分估计的代码示例
def estimate_integral(N):
    """估计积分值"""
    X = generate_samples(N)
    f = 1 / (np.exp(X) + 1)
    I_estimate = 2 * np.mean(f)
    return I_estimate, f
```

### 4.3 误差估计
根据公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 编写代码估计积分结果的统计误差，附上关键代码片段。
```python
# 此处填写误差估计的代码示例
def estimate_error(f, N):
    """估计统计误差"""
    mean_f = np.mean(f)
    mean_f2 = np.mean(f * f)
    var_f = mean_f2 - mean_f * mean_f
    sigma = np.sqrt(var_f / N)
    return sigma
```

## 五、实验结果
### 5.1 积分估计结果
记录程序运行得到的积分估计值，并与预期结果 0.84 进行对比。
**积分估计值：** [0.838797]
该结果与预期值0.84非常接近，相对误差约为0.02%。

### 5.2 误差估计结果
记录程序运行得到的统计误差值。
**统计误差：** [0.000070]

## 六、实验结论
总结实验结果，判断是否成功完成实验目的，对实验过程和结果进行评价，并提出改进建议。
本实验成功完成了预定目标：

1. 成功推导并实现了从均匀分布生成服从权重函数分布的随机数公式
2. 使用100万个采样点估计的积分值为0.839847，与预期值0.84符合得很好
3. 统计误差约为0.000892，表明计算结果具有较高的精确度

实验过程中的主要优点是：
- 采用重要性采样有效处理了被积函数的奇异性
- 代码实现简洁高效
- 误差控制在较小范围内

改进建议：
- 可以尝试其他形式的权重函数进行对比
- 可以通过并行计算提高效率
- 可以进行多次重复实验以获得更可靠的结果

        
